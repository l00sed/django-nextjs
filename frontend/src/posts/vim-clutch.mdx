<ProseWrapper>
### Goodwill Strikes Again

A symptom of heavy [Vim](https://www.vim.org) usage is that your brain begins to re-partition old memories for keyboard shortcutsâ€” trashing old brain files for small boosts in finger dexterity.

It was this mass of tangled brains in my own dome that compelled me to purchase a weighty foot-pedal at Goodwill. The model I got is actually a combination of three, springy switches. Sold for the reasonable price of $3.

<TwoColumn>
    <ImageWrapper
      src="/assets/img/articles/vim-clutch/screwdriver-thumbnail.jpg"
      alt="Picture of pedal assembly on it's face with a screwdriver in a screw-hole."
      width={ 500 }
      height={ 889 }
    />
    <ImageWrapper
      src="/assets/img/articles/vim-clutch/pedal_clicks.gif"
      alt="Animated picture of pedal right-side up, clicking in and out with my finger."
      width={ 300 }
      height={ 334 }
    />
</TwoColumn>


It's a surprisingly hefty contraption. The base is a thick stock of foam that helps keep it from sliding across the floor. It's a clamshell design, sandwiched together by a screw at each of the four corners.

Traditionally, I've coded with my fingers, and my feet remain flat on the floor. The thought of throwing another appendage into the mix had, however, actually crossed my mind (if you can believe it).

The serendipity of discovering the pedal among the other assortment of donated goods gave the idea shape.ðŸ¦†

### What the heck is a Vim Clutch?

Sometimes it feels like we're living in the future. A sci-fi fantasy where you can buy electric cars with digital coins and speculate on blockchains founded on memes.

Unsurprisingly, I'm not the only one under the _Vimperious_ curse... (yes, that was a Vim + Harry Potter pun) In fact, there have been a good many other model Vim Clutches:

</ProseWrapper>
<HorizontalScroller>
  <Card
    element={
      {
        id: "0",
        slug: "https://github.com/alevchuk/vim-clutch",
        image_alt: "The O.G. Vim Clutch by Aleksandr Levchuk, hooked up to a desktop.",
        featured_image: "/assets/img/articles/vim-clutch/og_pedal-thumbnail.jpg",
        title: "The O.G.?",
        updated_at: "April 2011",
        auto_update_at: "false",
        author: "Aleksandr Levchuk",
        description: "As far as I can tell, this is the O.G. Vim Clutch. First committed by Aleksandr Levchuk in 2011. Aleksandr uses <i>two</i> USB foot switches&mdash; costing $20. Not exactly thrift prices, but not at all bad. These pedals use an infrared sensor that gets interrupted by a <i>toothpick</i> when the pedal is depressed.<br><br>Aleksandr used one pedal for the \"i\" key, and the other for \"Esc\". So, I can imagine some real <i>Fast and Furious</i> vibes in Aleksandr's home office. The GitHub write-up that Aleksandr did is really excellent too&mdash; well-documented, and well worth a read.",
        unbound: "true"
      }
    }
  />
  <Card
    element={
      {
        id: "1",
        slug: "https://github.com/foxweb/vim-pedal",
        image_alt: "clutch",
        featured_image:"/assets/img/articles/vim-clutch/aleksey_two-thumbnail.jpg",
        title:"Aleksey #2",
        updated_at:"July 2014",
        auto_update_at:"false",
        author:"Aleksey Kurepin",
        description:"There's another great GitHub write-up (<i>Digression:</i> isn't it nice when people use GitHub READMEs like a blog post?) on a pedal by Aleksey Kurepin.Alek #2 called out Alek #1 (Levchuck) as the inspiration for this Vim Clutch project. Aleksey's pedal also uses an optical sensor to detect pedal presses. Aleksey, however, introduces an <i>Arduino Leonardo</i> microboard clone to send \"i\" on press <i>and</i> send \"Esc\" on release using the same pedal. Neat.",
        unbound: "true"
      }
    }
  />
  <Card
    element={
      {
        id: "2",
        slug: "https://spin.atomicobject.com/2017/04/07/vim-clutch/",
        image_alt: "A shoe about to press down on a unique-looking Vim clutch.",
        featured_image: "/assets/img/articles/vim-clutch/vim_clutch_shoe-thumbnail.jpg",
        title: "Fancy-Shoe Joe",
        updated_at: "April 2017",
        auto_update_at: "false",
        author: "Joe Chrysler",
        description: "Another super cool person, Joe Chrysler, wanted to ride the <i>Vim</i>bus 2000. This is a fun piece because Joe talks a little more about the other unique interfaces that he's seen and that have inspired him&mdash; curved, split, mechanical keyboards, giant trackpads, and Echo Dots to name a few.<br><br>Joe paid $25 bucks on Amazon for his \"sturdy, if somewhat sketchy\" pedal. I like these descriptions Joe, keep 'em coming.",
        unbound: "true"
      }
    }
  />
  <Card
    element={
      {
        id: "3",
        slug: "https://twitter.com/peterssonjesper/status/934957115709333505",
        image_alt: "Seemingly an electric piano pedal, but actually... a Vim clutch.",
        featured_image: "/assets/img/articles/vim-clutch/piano_pedal-thumbnail.jpg",
        title: "Piano Player",
        updated_at: "November 2017",
        auto_update_at: "false",
        author: "Jesper Petersson",
        description: "Pay special attention to the socks in this one, that's the true source of this programmer's text-editing prowess...<br><br>Jesper didn't seem to have a write-up on his pedal (correct me if I'm wrong, Jesper), just this short Twitter demo. I liked the allegory of the piano pedal, so I put it in the list.",
        unbound: "true"
      }
    }
  />
  <Card
    element={
      {
        id: "4",
        slug: "https://www.reddit.com/r/vimporn/comments/gus5ri/vim_clutch_vc1_pedal_by_boss/?utm_source=share&utm_medium=web2x&context=3",
        image_alt: "A modified BOSS guitar pedal. In convincing BOSS-style lettering, it says \"Vim Clutch\".",
        featured_image: "/assets/img/articles/vim-clutch/boss_pedal-thumbnail.jpg",
        title: "Boss Pedal, VC-1",
        updated_at: "June 2020",
        auto_update_at: "false",
        author: "u/sjachim",
        description: "This pedal is hardcore, rock-n-roll. I found it on Reddit, via <i>u/sjachim</i>. This project also has a recent timestamp (which means it's still a super cool, hip thing to do).<br><br>The <i>VC-1</i> model is a converted <i>BOSS</i> guitar pedal. It's one of the most legit-looking custom clutches that I've come across&mdash; especially with the vinyl-sticker lettering. The red pilot light also adds to the badass-ery. I might have to add some LEDs to mine...",
        unbound: "true"
      }
    }
  />
  <Card
    element={
      {
        id: "5",
        slug: "https://yeah.nah.nz/electronics/vim-clutch-2/",
        image_alt: "Close-up of this Vim clutch's wiring showing an Arduino and switch.",
        featured_image: "/assets/img/articles/vim-clutch/vim_clutch_micro-thumbnail.jpg",
        title: "Yeah, nah, aye",
        updated_at: "September 2020",
        auto_update_at: "false",
        author: "David Phillips",
        description: "David Phillips, a.k.a. <i>Yeah, nah, aye</i>, is another contemporary pedal hacker. Perhaps the flood of Vim clutches in 2020 is because all the developers were going crazy WFH. I don't know.<br><br>David's \"improved\" pedal (that's a Vim pun folks) uses an ATMega32u4 Arduino-compatible board. David also calls out Alek #1 as the O.G. Vim clutch hacker&mdash; and <i>does</i> indeed make some unique improvements upon the original project.<br><br>Definitely worth a read.",
        unbound: "true"
      }
    }
  />
  <Card
    element={
      {
        id: "6",
        slug: "https://github.com/moretea/kludge",
        image_alt: "Looking into the messy electronic innards of the \"Kludge\", another unique Vim clutch",
        featured_image: "/assets/img/articles/vim-clutch/kludge-thumbnail.jpg",
        title: "The Kludge",
        updated_at: "March 2021",
        auto_update_at: "false",
        author: "Maarten Hoogendoorn",
        description: "Hoogendoorn shared his pedal in the comments on <i>Hacker News</i>. The \"kludge\" pedal is also a misused piano pedal, similar in shape to one of the previous clutches. Maarten's, however, triples the fun with three switches.<br><br>My favorite part about Maarten's hack is that he also configured it to work as a push-to-talk pedal for calls! Wicked. Another excellent GitHub writeup and a unique way of coding it together.",
        unbound: "true"
      }
    }
  />
  <Card
    element={
      {
        id: "7",
        slug: "https://github.com/tenderlove/initial-v",
        image_alt: "A Vim clutch made from a salvaged BMW shifter and a 3D-printed enclosure.",
        featured_image: "/assets/img/articles/vim-clutch/clutch-thumbnail.jpg",
        title: "Initial V",
        updated_at: "March 2023",
        auto_update_at: "false",
        author: "Aaron Patterson",
        description: "Patterson (a.k.a. <i>tenderlove</i>) broke the mold when designing the <i>Initial V</i> Vim clutch. It's made from an actual BMW shifter and features a 3D-printed enclosure and custom PCB. It certainly feels antithetical to the Vim ethos of keeping our fingers planted firmly on the home-row; but, no one can deny this is a remarkable invention in the Vim clutch hall of fame.",
        unbound: "true"
      }
    }
  />
</HorizontalScroller>
<ProseWrapper>

Looking at these examples, it's clear that a Vim Clutch can assume many forms. At its core, a Vim Clutch is a pedal that engages or disengages the _INSERT_ mode in the Vim editor. In Vim (Visual-editor IMproved) you can type `i`,`I`,`a`,`A`, or a few other keys to enter _INSERT_ mode, pinning the cursor to specific starting locations.

_INSERT_ mode lets you type normallyâ€” like you would in a Google doc or in Notepad. Pressing the `Esc` button brings you back to _NORMAL_ mode...

<OneColumn>
    <ImageWrapper
      src="/assets/img/articles/vim-clutch/vim.svg"
      alt="Vim logo"
      width={ 100 }
      height={ 100 }
      caption={ false }
    />
</OneColumn>

If you've used Vim, then you know _NORMAL_ mode is anything but "normal". You can jump to matched characters, do clever search and replace maneuvers, build macros on-the-fly and much much more from within _NORMAL_ mode.

A proper _Vim Clutch_ would have to take the place of one of the _INSERT_-enabling and disabling key presses. Depressing the pedal would enter _INSERT_ mode, and releasing the pedal returns to _NORMAL_ mode.

Instead of settling into a cubicle'd menagerie of isolated and burnt-out developers, the _Vim Clutch_ puts you in the cockpit with Vim Dieselâ€” racing stick, staying above 50 words-per-minute to save all the innocent bus riders.

So that's the "what" and the "why", but before I give you the "how"â€” If you've made a dope Vim Clutch, and you're not in the listâ€” what gives?? Leave a comment, paste in some links or images. I'll put it in with the others.

### Vim-Clutch Hardware

The Goodwill pedal had about 4-feet of flat, fettuccine-looking cable coming out the back. It terminated in a telephone jack. After a quick Google search, it seemed like the pedal would have been used to control playback on a transcribing machine.

You'd engage the center pedal for normal playback, step on the left pedal to rewind, or step right to fast-foward while listening to a recording of speech. It would've provided a quick way to navigate (probably a casette) back and forth while simultaneously having both hands free to type out the actual letters and spellings of what was saidâ€” at a keyboard or electric typewriter, I'm guessing. Similar models go for a decent chunk of change on Amazon:

<OneColumn>
  <ImageWrapper
    src='/assets/img/articles/vim-clutch/amazon_dictaphone.jpg'
    width={ 860 }
    height={ 405 }
  />
</OneColumn>

All the more re-assured by the deal that I got, I decided to hack it apart and see what was happening inside. The previous owner definitely had cats. The insides contained a treasure-trove of hair, whiskers and dust bunnies.

There were two metal weights affixed to the bottom-half of the clamshell. They keep the pedal from scooting across the floor. Springs at each of the switches set-off the plastic pedals from engaging the switch mechanism. I looked up the string of numbers and letters that are printed on the side of each of the switches (out of curiousity); but no conclusive result about the design or manufacturer. The pedal itself has no distinguishing brand markings.

<OneColumn>
  <ImageWrapper
    src='/assets/img/articles/vim-clutch/pedal_guts-thumbnail.jpg'
    width={ 500 }
    height={ 281 }
  />
</OneColumn>

The springs are were also an exciting find. They could probably be swapped out, giving some control over the quality of the pedal's action. After playing with it, I feel like it'd be more comfortable to have a stiffer press. Right now, the weight of my foot is enough to create an accidental key-click.

### A Controller: RPi Zero

We'll have to add $10 to our budget. I decided to use the Raspberry Pi 0 for the keypress controllerâ€” the thing that'll turn our pedal presses into "i" and "Esc". That's $13 totalâ€¦ still worth it. I had a couple of the Pi 0 [SBCs](https://en.wikipedia.org/wiki/Single-board_computer) lying around from projects past, so it was a convenient option.

The Raspberry Pi 0 was a go-to board for some of my [school projects](/signs-of-life) in the past. I like the Zero model a lot. It's insane to have a programmable device that can use a display, provide WiFi and an SSH connection, GPIO and more for such a low price. Plus it's about the size of a few sticks of gum! Which is more than small enough to fit comfortably within the foot-pedal casing.

So now it's a project. I think the Pi will come in handy if I ever want to try sending keypresses via Bluetooth. Could you imagine that? The first (AFAIK) _wireless_ Vim Clutch. That would be legit. We'll see. Probably don't have the energy. I don't know, maybe that would be worth itâ€¦

Bottomline, the Pi 0 gives you a lot of flexibility in an exceptionally tiny form-factor. The physical interfaces of the Pi 0 are diverse and low-profileâ€” the micro-USB is convenient for simultaneously powering the device and sending data.

<OneColumn>
  <ImageWrapper
    src='/assets/img/articles/vim-clutch/rpi0_schematic-thumbnail.jpg'
    width={ 616 }
    height={ 346 }
  />
</OneColumn>

In the past, I'd tried setting up the headless Pi 0 using a single USB for both data and power. The tutorials online seem super straight-forward and fool-proof; but I've still never gotten it to work seamlessly.

The first Pi Zero I bought as a kit with all the silly dongles and adapters to plug in a mouse, keyboard, and display. I had more resolve to get it working this time, but still got into some muddy waters with setting up the Ethernet gadget for SSH'ing over USB.

A useful, succinct tutorial by [Andrew Mulholland](https://gist.github.com/gbaman/975e2db164b3ca2b51ae11e45e8fd40a#file-howtootgfast-md) provides the basic documentation for setting it up. There's also a good one from [Adafruit](https://learn.adafruit.com/turning-your-raspberry-pi-zero-into-a-usb-gadget/ethernet-gadget) that provides more context for Mac and Windows users. Most people seem to get it working by following those directions, but it always gets a little sticky for me.

### Raspberry Pi OS Config

On Linux (Ubuntu 20.04), I would install the [Raspberry Pi Imager](https://www.raspberrypi.org/software/) with aptitude:

<Pre>
```bash
sudo apt-get install rpi-imager
```
</Pre>


<Pre>
```py:keypress.py
def press(char):
  mod,key=hid_codes[char]
  raw=struct.pack("BBBBL", mod, 0x00, key, 0x00, 0x00000000)
  with open("/dev/hidg0", "w") as fd:
    fd.write(raw)
    fd.write(struct.pack("Q" 0))
    sleep(0.005)
```
</Pre>

<Pre>
```bash:/usr/bin/vimclutch_usb
#!/bin/bash
cd /sys/kernel/config/usb_gadget/
mkdir -p vimclutch
cd vimclutch
echo 0x1d6b > idVendor # Linux Foundation
echo 0x0104 > idProduct # Multifunction Composite Gadget
echo 0x0100 > bcdDevice # v1.0.0
echo 0x0200 > bcdUSB # USB2
mkdir -p strings/0x409
echo "fedcba9876543210" > strings/0x409/serialnumber
echo "l00sed" > strings/0x409/manufacturer
echo "VimClutch USB Device" > strings/0x409/product
mkdir -p configs/c.1/strings/0x409
echo "Config 1: ECM network" > configs/c.1/strings/0x409/configuration
echo 250 > configs/c.1/MaxPower # Add functions here
mkdir -p functions/hid.usb0
echo 1 > functions/hid.usb0/protocol
echo 1 > functions/hid.usb0/subclass
echo 8 > functions/hid.usb0/report_length
echo -ne \\x05\\x01\\x09\\x06\\xa1\\x01\\x05\\x07\\x19\\xe0\\x29\\xe7\\x15\\x00\\x25\\x01\\x75\\x01\\x95\\x08\\x81\\x02\\x95\\x01\\x75\\x08\\x81\\x03\\x95\\x05\\x75\\x01\\x05\\x08\\x19\\x01\\x29\\x05\\x91\\x02\\x95\\x01\\x75\\x03\\x91\\x03\\x95\\x06\\x75\\x08\\x15\\x00\\x25\\x65\\x05\\x07\\x19\\x00\\x29\\x65\\x81\\x00\\xc0 > functions/hid.usb0/report_desc
ln -s functions/hid.usb0 configs/c.1/# End functions
ls /sys/class/udc > UDC
```
</Pre>
</ProseWrapper>
